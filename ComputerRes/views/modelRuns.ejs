<!DOCTYPE html>
<html>
<head>
    <title>模型运行记录</title>
    <%- include headInclude.ejs %>
</head>
<body class="sticky-header">
<section>
    <!-- 左导航栏 -->
    <%- include header.ejs %>
    <div class="main-content">
        <!-- 上导航栏 -->
        <%- include nav.ejs %>

        <div class="panel panel-default" style="background: #EFF0F4;">
            <div class="panel-body">
                <table  class="display table table-bordered table-striped" id="tb_msr">
                    <thead>
                    <tr>
                        <td>记录ID</td>
                        <td>名称</td>
                        <td>GUID
                        <% if(host!= 'localhost'){ %>
                            <td>地址</td>
                        <% } %>
                        <td>调用时间</td>
                        <td>状态</td>
                        <td>操作</td>
                    </tr>
                    </thead>
                    <tbody id="tb_data">
                        <% if(host == 'localhost'){ %>
                            <% for(var i = 0; i < msr.length; i++) {%>
                            <tr>
                                <td><%=msr[i]._id %></td>
                                <td><%=msr[i].msr_ms.ms_model.m_name %></td>
                                <td><%=msr[i].msr_guid %></td>
                                <td><%=msr[i].msr_date %></td>
                                <td><% if(msr[i].msr_time == 0){%>未完成<%}else{%>已完成<%} %></td>
                                <td><a href="/modelserrun/<%=msr[i]._id %>">查看详情</a></td>
                            </tr>
                            <% } %>
                        <% }else{ %>
                            <% childmsr.forEach(function (cmsr) { %>
                                <% if(cmsr.ping == 'suc') {
                                    var items = cmsr.msr;
                                    items.forEach(function (msr) { %>
                                        <tr>
                                            <td><%=msr._id %></td>
                                            <td><%=msr.msr_ms.m_name %></td>
                                            <td><%=msr.msr_guid %></td>
                                            <td><%=cmsr.host %></td>
                                            <td><%=msr.msr_date %></td>
                                            <td><% if(msr.msr_status == 0){%>未完成<%}else if(msr_status == 1){%>已完成<%} else if(msr_status == -1){%>出现异常<%} %></td>
                                            <td><a href="/modelserrun/rmt/<%=cmsr.host%>/<%=msr._id %>">查看详情</a></td>
                                        </tr>
                                    <% });
                                }
                            });
                        } %>
                    </tbody>
                </table>
            </div>
        </div>

        <%- include footer.ejs %>
    </div>
</section>
<%- include footerInclude.ejs %>
<script type="text/javascript" language="javascript" src="/js/advanced-datatable/js/jquery.dataTables.js"></script>
<script type="text/javascript" src="/js/data-tables/DT_bootstrap.js"></script>
<script type="text/javascript" >
    $('#tb_msr').dataTable(
            {
                //表格汉化
                "data-locale":"zh-US",
                //载入数据的时候是否显示“正在加载中...”
                "processing": true,
                //是否显示分页
                "bPaginate": true,
                //每页显示条目数
                "bLengthChange": false,
                //搜索栏
                "bFilter": false,
                //排序
                "bSort": true,
                //排序配置
                "aaSorting": [[1, "desc"]],
                //自适应宽度
                "bAutoWidth": true,
                //多语言配置
                "oLanguage": {
                    "sLengthMenu": "每页显示 _MENU_ 条记录",
                    "sZeroRecords": "对不起，查询不到任何相关数据",
                    "sInfo": "当前显示 _START_ 到 _END_ 条，共 _TOTAL_ 条记录",
                    "sInfoEmtpy": "找不到相关数据",
                    "sInfoFiltered": "数据表中共为 _MAX_ 条记录",
                    "sProcessing": "正在加载中...",
                    "sSearch": "搜索",
                    //多语言配置文件，可将oLanguage的设置放在一个txt文件中，例：Javascript/datatable/dtCH.txt
                    "sUrl": "",
                    "oPaginate": {
                        "sFirst":    "第一页",
                        "sPrevious": " 上一页 ",
                        "sNext":     " 下一页 ",
                        "sLast":     " 最后一页 "
                    }
                }
            });
</script>
</body>
</html>
